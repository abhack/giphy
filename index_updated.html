<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div>
        <input type="text" name="srch" id="srch_input">
        <input type="button" value="Search" id="srch-btn">
    </div>
    <div></div>
    <input type="text" name="lname" id="btn_input">
    <input type="submit" value="Submit Topic" id="sbmt">
    <div id="pic_btns"></div>
    <div style="display:flex; flex-wrap:wrap; justify-content: center" id="pics"></div>
    <script>
        const key = 'ecIHIIxXu0erhdpsCv4omv5fmNQn7ixD';
        document.getElementById("sbmt").addEventListener("click", function(e) {
            e.preventDefault();
            const inputVal = document.getElementById("btn_input").value;
            const btn = document.createElement("button");
            btn.innerText = inputVal;
            document.getElementById("pic_btns").appendChild(btn);
        });
        
        var query = ''
        document.getElementById("srch-btn").addEventListener("click", function(e) {
            e.preventDefault();
            document.getElementById("pic_btns").removeChild
            document.getElementById("pics").innerHTML = ''
            query = document.getElementById("srch_input").value;
            const promise = ajaxCall(query);
            promise.then(e => e.data.map(e1 => addPic(e1)));
        })

        function ajaxCall(query) {
            const url = `https://api.giphy.com/v1/gifs/search?q=${query}&api_key=${key}&limit=25`
            return fetch(url)
            .then(function(response){
                return response.json()
            })
        }
        
        function addPic(respObj) {
            const still = respObj.images.original_still.url;
            const gif   = respObj.images.original.url;

            const newPic = document.createElement("img");
            newPic.dataset.still = still;
            newPic.dataset.gif   = gif;
            newPic.dataset.isMoving = false;
            newPic.classList.add("pic");
            newPic.src = still;
            newPic.style.width = "22%";
            newPic.style.height = "22%";
            let x = document.getElementById("pics");
            document.getElementById("pics").appendChild(newPic);
        }

        document.getElementById("pics").addEventListener("click", function(event) {
            if(!event.target.classList.value.includes("pic")) return;
            var { isMoving } = event.target.dataset;   // {  } = a deconstructed object, returns object differently
            console.log(isMoving)
            console.log("clicked item is pic & isMoving = " + isMoving );
            if(isMoving === "false") {
                console.log("isMoving = false, change to true")
                event.target.src = event.target.dataset.gif;
                event.target.dataset.isMoving = "true";
                console.log("isMoving now = " + event.target.dataset.isMoving + " should = true & image should be moving")    
            } 
            else {
                console.log("isMoving = true change to false")
                event.target.src = event.target.dataset.still;
                event.target.dataset.isMoving = "false";
                console.log("isMoving now = " + event.target.dataset.isMoving +" should = false & image should be still")
            }
        })

    
    </script>
</body>
</html> 